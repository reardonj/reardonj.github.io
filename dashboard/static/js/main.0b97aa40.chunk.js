(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[0],{208:function(e,t,n){},231:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(20),a=n.n(r),c=n(2),o=n(245),s=n(112),l=n(41),u=n(51),d=n(22),j=n(248),h=n(246),m=n(33);function p(e,t){var n=Object(i.useState)(e),r=Object(l.a)(n,2),a=r[0],c=r[1];return Object(i.useEffect)((function(){return t().subscribe((function(e){return c(e)})).unsubscribe}),[]),a}var b=n(15),f=o.l.create({className:"toaster",position:b.a.BOTTOM}),O=n(3);function w(e){var t=e.appState;return Object(O.jsxs)(o.g,{children:[Object(O.jsx)(o.g.Group,{align:u.a.LEFT,children:Object(O.jsx)(o.g.Heading,{children:"JR's Dashboard"})}),Object(O.jsxs)(o.g.Group,{align:u.a.RIGHT,children:[Object(O.jsx)(g,{appState:t}),Object(O.jsx)(x,{appState:t})]})]})}function g(e){var t=e.appState,n=Object(i.useState)(""),r=Object(l.a)(n,2),a=r[0],c=r[1];return Object(i.useEffect)((function(){return Object(j.a)([Object(h.a)(0,1e3),t.weatherReport.pipe(Object(m.a)((function(e){return null===e||void 0===e?void 0:e.time})))]).subscribe((function(e){var t,n=Object(l.a)(e,2),i=(n[0],n[1]);c((t=i)?"As of "+d.DateTime.fromSeconds(t).toRelative():"")})).unsubscribe}),[t]),Object(O.jsx)("div",{children:a})}function x(e){var t=e.appState,n=p(!1,(function(){return t.loading})),r=p(!1,(function(){return t.loadingError}));return Object(i.useEffect)((function(){if(r){var e=Object(O.jsxs)("div",{children:[Object(O.jsx)("b",{children:"Failed to Load Forecast"}),Object(O.jsx)("br",{}),r.error]});f.show({message:e,icon:"error",intent:"warning"})}}),[r]),Object(O.jsx)(o.a,{loading:n,onClick:function(){return t.loadTrigger.next()},intent:r?"warning":"success",children:Object(O.jsx)(o.f,{icon:r?"outdated":"refresh"})})}var v=n(87),y=n(59),T=n(76),N=n(86);function S(e){var t=e.appState,n=p(null,(function(){return t.weatherReport.pipe(Object(m.a)((function(e){return null===e||void 0===e?void 0:e.current})))}));return Object(O.jsxs)(o.b,{children:[Object(O.jsxs)("div",{className:"report-line",children:[Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.d,{children:["Current Weather",Object(O.jsx)("span",{className:[c.a.TEXT_MUTED,c.a.TEXT_SMALL,c.a.UI_TEXT].join(" "),children:n?Object(O.jsxs)(O.Fragment,{children:[" as of ",d.DateTime.fromSeconds(n.time).toLocal().toLocaleString(d.DateTime.TIME_24_SIMPLE)]}):Object(O.jsx)(O.Fragment,{children:" unavailable"})})]}),Object(O.jsx)("div",{className:"overflow-container",children:Object(O.jsx)(o.k,{ellipsize:!0,children:null===n||void 0===n?void 0:n.conditions})}),(null===n||void 0===n?void 0:n.relativeHumidity)?Object(O.jsx)("div",{className:"overflow-container",children:Object(O.jsxs)(o.k,{ellipsize:!0,children:[null===n||void 0===n?void 0:n.relativeHumidity,"% Relative Humidity"]})}):Object(O.jsx)(O.Fragment,{})]}),n?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"spacer"}),D(n.temperature,n.humidex,n.windChill),Object(O.jsx)("div",{className:"weather-icon",children:Object(O.jsx)("i",{className:"wi-fw "+(n.icon||"wi wi-na")})})]}):Object(O.jsx)(O.Fragment,{})]}),Object(O.jsx)(M,{})]})}function E(e){var t,n=e.appState,i=p(null,(function(){return n.weatherReport.pipe(Object(m.a)((function(e){return null===e||void 0===e?void 0:e.forecasts})))})),r=null!==(t=null===i||void 0===i?void 0:i.map(k))&&void 0!==t?t:Object(O.jsx)("div",{className:c.a.TEXT_MUTED,children:"unavailable"});return Object(O.jsxs)(o.b,{children:[Object(O.jsx)(o.d,{children:"Forecast"}),i?A(i):Object(O.jsx)(O.Fragment,{}),r]})}function C(e){var t=e.appState,n=p(null,(function(){return t.weatherReport.pipe(Object(m.a)((function(e){return null===e||void 0===e?void 0:e.hourlyForecasts})))}));return Object(O.jsxs)(o.b,{children:[Object(O.jsx)(o.d,{children:"Hourly Forecast"}),n?A(n):Object(O.jsx)(O.Fragment,{}),Object(O.jsx)("div",{className:"hourly-forecasts",children:n?Object(O.jsx)("table",{cellSpacing:0,children:Object(O.jsx)("tbody",{children:n.map(R)})}):Object(O.jsx)("div",{className:c.a.TEXT_MUTED,children:"unavailable"})})]})}function F(e){var t=e.appState,n=p(void 0,(function(){return t.weatherReport.pipe(Object(m.a)((function(e){return null===e||void 0===e?void 0:e.warnings})))}));if(void 0===n)return Object(O.jsx)(O.Fragment,{});var i=c.a.INTENT_PRIMARY;return n.items.find((function(e){return"high"===e.priority||"urgent"===e.priority}))?i=c.a.INTENT_DANGER:n.items.find((function(e){return"medium"===e.priority}))&&(i=c.a.INTENT_WARNING),Object(O.jsxs)(o.b,{onClick:function(){return window.open(n.url)},interactive:!0,className:[c.a.CALLOUT,i].join(" "),children:[" ",null===n||void 0===n?void 0:n.items.map((function(e){var t=e.type.length>0?e.type:"Warning";return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(o.d,{children:t}),Object(O.jsx)(o.k,{children:e.description.length>55?e.description.slice(0,53)+"\u2026":e.description})]})}))]})}function D(e,t,n){var i=t||n,r="".concat(e.toFixed(0),"\xb0C");if(i){var a=Object(O.jsxs)(O.Fragment,{children:["Actual: ",r,Object(O.jsx)("br",{}),t&&"Humidex: ".concat(t.toFixed(0),"\xb0C"),n&&"Windchill: ".concat(n.toFixed(0),"\xb0C")]});return Object(O.jsx)(y.a,{content:a,position:"top",className:T.a.TOOLTIP2_INDICATOR,children:"".concat(i.toFixed(0),"\xb0C")})}return"".concat(e.toFixed(0),"\xb0C")}function k(e){return Object(O.jsxs)("div",{className:["report-line","forecast",e.title.endsWith("night")?"night":"day"].join(" "),children:[Object(O.jsxs)("div",{children:[Object(O.jsx)(o.e,{children:e.title}),Object(O.jsx)(y.a,{content:L(e),position:"top",className:T.a.TOOLTIP2_INDICATOR,children:e.conditions.length>35?e.conditions.slice(0,33)+"\u2026":e.conditions})]}),Object(O.jsx)("div",{className:"spacer"}),Object(O.jsx)("div",{className:"temperature",children:D(e.temperature,e.humidex,e.windChill)}),Object(O.jsx)("div",{className:"weather-icon",children:Object(O.jsx)("i",{className:"wi-fw "+(e.icon||"wi wi-na")})})]},e.title)}function R(e){var t=d.DateTime.fromSeconds(e.time,{zone:d.FixedOffsetZone.utcInstance}).toLocal(),n=t.day===d.DateTime.now().day?"today":"tomorrow";return Object(O.jsxs)("tr",{className:["report-line","forecast","hourly",n].join(" "),children:[Object(O.jsx)("td",{className:"time-title",children:Object(O.jsx)(o.e,{className:_(e),children:I(t)})}),Object(O.jsx)("td",{className:"temperature",children:D(e.temperature,e.humidex,e.windChill)}),Object(O.jsx)("td",{children:Object(O.jsx)("i",{className:"wi-fw "+(e.icon||"wi wi-na")})}),Object(O.jsx)("td",{children:e.pop>0?e.pop.toLocaleString(void 0,{style:"percent"}):""}),Object(O.jsx)("td",{children:e.conditions.length>20?Object(O.jsx)(y.a,{content:e.conditions,position:"top",className:T.a.TOOLTIP2_INDICATOR,children:e.conditions.slice(0,18)+"\u2026"}):e.conditions})]},e.time)}function M(){var e=new Date;return Object(O.jsxs)("div",{className:"report-line",children:[Object(O.jsx)(o.d,{children:"Sunrise/Sunset"}),Object(O.jsx)("div",{className:"spacer"}),Object(O.jsxs)("div",{children:[Object(O.jsx)("i",{className:"wi wi-sunrise"})," ",I(d.DateTime.fromJSDate(Object(N.getSunrise)(45.33,-75.58,e)))]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("i",{className:"wi wi-sunset"})," ",I(d.DateTime.fromJSDate(Object(N.getSunset)(45.33,-75.58,e)))]})]})}function I(e){return e.toLocal().toLocaleString(d.DateTime.TIME_24_SIMPLE)}function _(e){return e.pop>=.5?"warning":""}function A(e){var t=e.map((function(e){return e.humidex||e.windChill||e.temperature})),n=Math.min.apply(Math,Object(v.a)(t)),i=Math.max.apply(Math,Object(v.a)(t))-n,r=t.map((function(e){return 1-(e-n)/i})),a=1/(r.length-1),c=r.reduce((function(e,t,n){return 0===n?"M 0 ".concat(t," "):e+"C ".concat((n-.5)*a," ").concat(r[n-1],", ").concat((n-.5)*a," ").concat(t,", ").concat(n*a," ").concat(t,"\n ")}),"");return Object(O.jsxs)("svg",{className:"temperature-spark",viewBox:"0 -0.1 1 1.2",preserveAspectRatio:"none",children:[Object(O.jsx)("path",{strokeWidth:"1px",stroke:"#f99",vectorEffect:"non-scaling-stroke",fill:"transparent",d:"M 0 ".concat(1-(30-n)/i," h 1")}),Object(O.jsx)("path",{strokeWidth:"1px",stroke:"#999",vectorEffect:"non-scaling-stroke",fill:"transparent",d:"M 0 ".concat(1-(0-n)/i," h 1")}),Object(O.jsx)("path",{strokeWidth:"1px",stroke:"#99f","vector-effect":"non-scaling-stroke",fill:"transparent",d:"M 0 ".concat(1-(-20-n)/i," h 1")}),Object(O.jsx)("path",{strokeWidth:"1px",stroke:"#999",vectorEffect:"non-scaling-stroke",fill:"transparent",d:c})]})}function L(e){return e.fullReport+function(e){if(1===e.length)return" ".concat(e[0].amount).concat(e[0].units,".");return e.map((function(e){return" ".concat(e.amount).concat(e.units," of ").concat(e.type,".")})).join("")}(e.precipitation)}n(208);var B=function(e){var t=e.appState,n=Object(s.useModeSelector)({dark:c.a.DARK,light:"",unset:""});return Object(O.jsxs)("div",{className:n,id:"layout-root",children:[Object(O.jsx)(w,{appState:t}),Object(O.jsx)("div",{children:Object(O.jsxs)("div",{className:"card-grid",children:[Object(O.jsx)(S,{appState:t}),Object(O.jsx)(F,{appState:t}),Object(O.jsx)(C,{appState:t}),Object(O.jsx)(E,{appState:t})]})}),Object(O.jsx)(o.c,{}),Object(O.jsx)("footer",{className:c.a.TEXT_MUTED,children:"Contains information licenced under the Data Server End-use Licence of Environment and Climate Change Canada."})]})},H=n(244);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=n(73),U=n(117),P=n(119),G=n(120),X=n(30),z=n(239),J=n(240),V=n(118),Y=n.n(V),Z={0:"wi-day-sunny",1:"wi-day-sunny-overcast",2:"wi-day-cloudy",3:"wi-day-cloudy-high",4:"wi-day-cloudy-high",5:"wi-day-sunny-overcast",6:"wi-day-showers",7:"wi-day-rain-mix",8:"wi-day-snow",9:"wi-day-storm-showers",10:"wi-cloudy",11:"wi-rain",12:"wi-showers",13:"wi-rain",14:"wi-sleet",15:"wi-rain-mix",16:"wi-snow",17:"wi-snow",18:"wi-snow",19:"wi-thunderstorm",23:"wi-dust",24:"wi-fog",25:"wi-snow-wind",26:"wi-hail",27:"wi-hail",28:"wi-sprinkle",30:"wi-night-clear",31:"wi-night-alt-partly-cloudy",32:"wi-night-alt-cloudy",33:"wi-night-alt-cloudy-high",34:"wi-night-alt-cloudy-high",35:"wi-night-alt-partly-cloudy",36:"wi-night-alt-showers",37:"wi-night-alt-rain-mix",38:"wi-night-alt-snow",39:"wi-night-alt-thunderstorm",40:"wi-night-alt-snow-wind",41:"wi-tornado",42:"wi-tornado",43:"wi-strong-wind",44:"wi-smoke",45:"wi-dust",46:"wi-hail",47:"wi-thunderstorm",48:"wi-tornado"};function K(e){if(e in Z)return"wi "+Z[e]}var $=function(e){Object(U.a)(n,e);var t=Object(P.a)(n);function n(e){return Object(W.a)(this,n),t.call(this,e)}return n}(Object(G.a)(Error));function q(e,t,n){var i,r,a;if("string"===typeof t)r=t,a=[];else{if(0===t.length)return e;r=t[0],a=t.slice(1)}var c=null===(i=e.getElementsByTagName(r))||void 0===i?void 0:i[0];if(!c&&!n)throw new $("".concat(e.tagName," missing element ").concat(t));return a.length>0?q(c,a,n):c}function Q(e,t){var n=e.getAttribute(t);if(!n)throw new $("".concat(e.tagName," missing attribute ").concat(t));return n}function ee(e,t){var n=null===e||void 0===e?void 0:e.textContent;if(!n&&!t)throw new $("Element or content was missing");return n}function te(e,t){var n=ee(e,t);if(!n&&t)return null;var i=Number(n);if(isNaN(i))throw new $("".concat(e.tagName," does not contain a number"));return i}function ne(e){return d.DateTime.utc(te(q(e,"year")),te(q(e,"month")),te(q(e,"day")),te(q(e,"hour")),te(q(e,"minute")))}function ie(e){var t=q(e,"abbreviatedForecast");return{title:Q(q(e,"period"),"textForecastName"),icon:K(te(q(t,"iconCode"))),fullReport:ee(q(e,"textSummary")),conditions:ee(q(t,"textSummary")),temperature:te(q(e,["temperatures","temperature"])),windChill:null,humidex:te(q(e,["humidex","calculated"],!0),!0),precipitation:re(q(e,"precipitation",!0))}}function re(e){return e?Array.from(e.getElementsByTagName("accumulation")).map((function(e){var t=q(e,"amount");return{type:q(e,"name").textContent||"unknown precipitation",amount:te(t),units:Q(t,"units")}})):[]}function ae(e){var t=Array.from(e.getElementsByTagName("dateTime")).find((function(e){return"UTC"===e.getAttribute("zone")}));if(!t)throw new $("currentConditions missing UTC dateTime");return{time:ne(t).toSeconds(),conditions:ee(q(e,"condition")),temperature:te(q(e,"temperature")),icon:K(te(q(e,"iconCode"))),windChill:te(q(e,"windChill",!0),!0),humidex:te(q(e,"humidex",!0),!0),relativeHumidity:te(q(e,"relativeHumidity",!0),!0)}}function ce(e){return Array.from(e.getElementsByTagName("hourlyForecast")).map((function(e){var t=Q(e,"dateTimeUTC");return{time:d.DateTime.fromFormat(t,"yyyyMMddHHmm",{zone:d.FixedOffsetZone.utcInstance}).toSeconds(),conditions:ee(q(e,"condition")),temperature:te(q(e,"temperature")),icon:K(te(q(e,"iconCode"))),windChill:te(q(e,"windChill",!0),!0),humidex:te(q(e,"humidex",!0),!0),pop:(te(q(e,"lop",!0),!0)||0)/100}}))}function oe(e){switch(e){case"low":return"low";default:return"medium";case"high":return"high";case"urgent":return"urgent"}}function se(e){var t=e.getAttribute("url");if(null!==t)return{url:null!==t&&void 0!==t?t:"",items:Array.from(e.getElementsByTagName("event")).map((function(e){return{description:Q(e,"description"),type:Q(e,"type"),priority:oe(Q(e,"priority"))}}))}}n(227),n(228),n(229),n(230);var le=n(75),ue=n(249),de=n(241),je=n(247),he=n(250),me=n(242),pe=n(243);var be={fetchState:"started"},fe={fetchState:"finished"};function Oe(e){return"object"===typeof e&&"fetchState"in e&&("started"===e.fetchState||"finished"===e.fetchState)}var we=function e(t){Object(W.a)(this,e),this.loadTrigger=void 0,this.loading=void 0,this.loadingError=void 0,this.weatherReport=void 0,this.loadTrigger=new le.a;var n=Object(ue.a)(this.loadTrigger.pipe(Object(de.a)((function(){return Object(je.a)(Object(J.a)(be),t(),Object(J.a)(fe))})),Object(he.a)()),Oe),i=Object(l.a)(n,2),r=i[0],a=i[1];this.loading=r.pipe(Object(m.a)((function(e){return"started"===e.fetchState})),Object(me.a)(),Object(he.a)({connector:function(){return new pe.a(!1)}})),this.weatherReport=a.pipe(Object(m.a)((function(e){return"string"===typeof e?null:e})),Object(he.a)({connector:function(){return new pe.a(null)}})),this.loadingError=a.pipe(Object(m.a)((function(e){return"string"===typeof e&&{error:e}})),Object(me.a)(),Object(he.a)({connector:function(){return new pe.a(!1)}}))},ge=new we((function(){return Object(X.a)(Y()("https://dashboard-proxy.jmreardon.com/api/weather/citypage_weather/xml/ON/s0000430_e.xml")).pipe(Object(m.a)((function(e){return function(e){var t,n=e.evaluate('/siteData/dateTime[@name="xmlCreation" and @zone="UTC"]',e,void 0,XPathResult.FIRST_ORDERED_NODE_TYPE);if(!(n.singleNodeValue instanceof Element))throw new $("Missing creation time");return{time:ne(n.singleNodeValue).toSeconds(),current:ae(e.getElementsByTagName("currentConditions")[0]),forecasts:(t=e.getElementsByTagName("forecastGroup")[0],Array.from(t.getElementsByTagName("forecast")).map(ie)),hourlyForecasts:ce(e.getElementsByTagName("hourlyForecastGroup")[0]),warnings:se(e.getElementsByTagName("warnings")[0])}}((new DOMParser).parseFromString(e.data,"text/xml"))})),Object(z.a)((function(e,t){return Object(J.a)(function(e){return e instanceof $?e.message:"unexpected error: "+e}(e))})))}));Object(h.a)(0,9e5).pipe(Object(H.a)(void 0)).subscribe(ge.loadTrigger),a.a.render(Object(O.jsx)(i.StrictMode,{children:Object(O.jsx)(B,{appState:ge})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[231,1,2]]]);